<?xml version="1.0" encoding="utf-8" ?>
<Patch>

  <Operation Class="XmlExtensions.OptionalPatch">
    <modId>Harkon.GunNut.CORE</modId>
    <key>replaceCoreGrenadeSound</key>
    <defaultValue>true</defaultValue>
    <caseTrue>

      <!-- === General === -->
      <Operation Class="PatchOperationReplace">
        <xpath> /Defs/ThingDef[defName="Weapon_GrenadeFrag"]/verbs/li/soundCast | /Defs/ThingDef[defName="Weapon_GrenadeEMP"]/verbs/li/soundCast
        </xpath>
        <value>
          <soundCast>Throw_GSP_Grenade</soundCast>
        </value>
      </Operation>

      <!-- === Frag Grenade === -->
      <Operation Class="PatchOperationAdd">
        <xpath>/Defs/ThingDef[defName="Proj_GrenadeFrag"]/projectile</xpath>
        <value>
          <soundExplode>FragGrenade_Explode</soundExplode>
        </value>
      </Operation>

      <Operation Class="PatchOperationReplace">
        <xpath>/Defs/ThingDef[defName="Weapon_GrenadeFrag"]/soundInteract</xpath>
        <value>
          <soundInteract>Interact_GSP_Grenade</soundInteract>
        </value>
      </Operation>

      <!-- === COMBAT EXTENDED === -->
      <Operation Class="PatchOperationFindMod">
        <mods>
          <li>Combat Extended</li>
        </mods>

        <match Class="PatchOperationSequence">
          <operations>
            <!-- === Flashbang === -->
            <li Class="PatchOperationReplace">
              <xpath>/Defs/ThingDef[defName="Proj_GrenadeFlashbang"]/projectile/soundExplode</xpath>

              <value>
                <soundExplode>FlashbangGrenade_Explode</soundExplode>
              </value>
            </li>

            <!-- === Smoke Grenade === -->
            <li Class="PatchOperationAdd">
              <xpath>/Defs/ThingDef[defName="Proj_GrenadeSmoke"]/projectile</xpath>

              <value>
                <soundExplode>SmokeGrenade_Explode</soundExplode>
              </value>
            </li>

            <!-- === Interact Grenade === -->
            <li Class="PatchOperationReplace">
              <xpath> /Defs/ThingDef[defName="Weapon_GrenadeFlashbang"]/soundInteract | /Defs/ThingDef[defName="Weapon_GrenadeSmoke"]/soundInteract | /Defs/ThingDef[defName="Weapon_GrenadeFirefoam"]/soundInteract
              </xpath>

              <value>
                <soundInteract>Interact_GSP_Grenade</soundInteract>
              </value>
            </li>

            <!-- === Throw Grenade === -->
            <li Class="PatchOperationReplace">
              <xpath> /Defs/ThingDef[defName="Weapon_GrenadeFlashbang"]/verbs/li/soundCast | /Defs/ThingDef[defName="Weapon_GrenadeSmoke"]/verbs/li/soundCast | /Defs/ThingDef[defName="Weapon_GrenadeFirefoam"]/verbs/li/soundCast
              </xpath>

              <value>
                <soundCast>Throw_GSP_Grenade</soundCast>
              </value>
            </li>
          </operations>
        </match>
      </Operation>

    </caseTrue>
  </Operation>

</Patch>